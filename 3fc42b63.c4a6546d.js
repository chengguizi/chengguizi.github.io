(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{140:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var i=a(0),r=a.n(i);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,i,r=function(e,t){if(null==e)return{};var a,i,r={},n=Object.keys(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)a=n[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var b=r.a.createContext({}),s=function(e){var t=r.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=s(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var a=e.components,i=e.mdxType,n=e.originalType,o=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),d=s(a),p=i,m=d["".concat(o,".").concat(p)]||d[p]||u[p]||n;return a?r.a.createElement(m,l(l({ref:t},b),{},{components:a})):r.a.createElement(m,l({ref:t},b))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var n=a.length,o=new Array(n);o[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var b=2;b<n;b++)o[b]=a[b];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}p.displayName="MDXCreateElement"},173:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/calibration_board-6affc1acb25521a54f1b2713f04af194.jpg"},78:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return s}));var i=a(2),r=a(6),n=(a(0),a(140)),o={hide_title:!0,sidebar_label:"Multi-Camera Calibration"},l={unversionedId:"research/calibration/using-kalibr-calibration",id:"research/calibration/using-kalibr-calibration",isDocsHomePage:!1,title:"using-kalibr-calibration",description:"Multi-Camera Calibration",source:"@site/docs/research/calibration/using-kalibr-calibration.md",permalink:"/docs/research/calibration/using-kalibr-calibration",editUrl:"https://github.com/chengguizi/chengguizi.github.io/docs/research/calibration/using-kalibr-calibration.md",lastUpdatedAt:1597829776,sidebar_label:"Multi-Camera Calibration",sidebar:"researchSidebar",previous:{title:"index",permalink:"/docs/research/calibration/index"},next:{title:"verify-calibration",permalink:"/docs/research/calibration/verify-calibration"}},c=[{value:"TL; NR (Calibration Procedures)",id:"tl-nr-calibration-procedures",children:[]},{value:"Calibration Target",id:"calibration-target",children:[{value:"About <code>low_id</code>",id:"about-low_id",children:[]}]},{value:"Installation",id:"installation",children:[]},{value:"Optionally to Calibrate IMU-Camera",id:"optionally-to-calibrate-imu-camera",children:[{value:"The IMU Config File",id:"the-imu-config-file",children:[]}]}],b={rightToc:c};function s(e){var t=e.components,o=Object(r.a)(e,["components"]);return Object(n.b)("wrapper",Object(i.a)({},b,o,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h1",{id:"multi-camera-calibration"},"Multi-Camera Calibration"),Object(n.b)("p",null,"What would be done in this tutorial:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Prepare calibration target config file - ",Object(n.b)("inlineCode",{parentName:"li"},"./april_5x5.yaml"))),Object(n.b)("p",null,"Optionally:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Prepare imu config file - ",Object(n.b)("inlineCode",{parentName:"li"},"./imu.yaml"))),Object(n.b)("h2",{id:"tl-nr-calibration-procedures"},"TL; NR (Calibration Procedures)"),Object(n.b)("h2",{id:"calibration-target"},"Calibration Target"),Object(n.b)("p",null,"It is strongly recommended to use Aprilgrid as the calibration target as"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"partially visible calibration boards can be used"),Object(n.b)("li",{parentName:"ul"},"pose of the target is fully resolved (no flips)")),Object(n.b)("p",null,"More details can be found on the Kalibr's ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/ethz-asl/kalibr/wiki/calibration-targets"}),"wiki page"),", and a sample grid starting from detection id 0 is available ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://drive.google.com/file/d/0B0T1sizOvRsUdjFJem9mQXdiMTQ/edit"}),"here"),". "),Object(n.b)("p",null,"Below is the current Aprilgrid calibration board we are using and its corresponding ",Object(n.b)("inlineCode",{parentName:"p"},".yaml")," file."),Object(n.b)("p",null,Object(n.b)("img",{alt:"calibration_board",src:a(173).default})),Object(n.b)("pre",null,Object(n.b)("code",Object(i.a)({parentName:"pre"},{className:"language-yaml",metastring:'title="april_5x5.yaml"',title:'"april_5x5.yaml"'}),"  target_type: 'aprilgrid'      #gridtype\n  tagCols: 5                    #number of apriltags\n  tagRows: 5                    #number of apriltags\n  tagSize: 0.1500               #size of apriltag, edge to edge [m]\n  tagSpacing: 0.30001           #ratio of space between tags to tagSize, for our apriltag spacing = 0.029\n  low_id: 25                    #the lowest detection id within the grid, normally on the bottom-left\n")),Object(n.b)("h3",{id:"about-low_id"},"About ",Object(n.b)("inlineCode",{parentName:"h3"},"low_id")),Object(n.b)("p",null,"Observe that the first grid (closest to the coordinate marker) in the board above has the same encoding as the 26-th grid in a typical ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://drive.google.com/file/d/0B0T1sizOvRsUdjFJem9mQXdiMTQ/edit"}),"board"),". This is because the board we are using is purpose-made to start from a different id other than the default zero. Therefore, the ",Object(n.b)("inlineCode",{parentName:"p"},"low_id")," field is to be added in the yaml file to tell the calibration algorithm about this fact."),Object(n.b)("p",null,"The stock Kalibr pacakges does not support defining the lowest id natively (it always assumes the id starts from 0), hence we have added the ",Object(n.b)("inlineCode",{parentName:"p"},"low_id")," feature, refering to the ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/chengguizi/kalibr/commit/8d1a7846ab3ad9d5475fa3b816c92b90da8f6eb8"}),"commit"),"."),Object(n.b)("h2",{id:"installation"},"Installation"),Object(n.b)("p",null,"Kalibr is a ROS package, so it is to be cloned into the ",Object(n.b)("inlineCode",{parentName:"p"},"src/")," directory of the caktin workspace."),Object(n.b)("p",null,"This version builds on top of the official repository, which:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"works with a calibration board with non-zero ",Object(n.b)("inlineCode",{parentName:"li"},"low_id")," "),Object(n.b)("li",{parentName:"ul"},"works correctly with Double Sphere Camera Model")),Object(n.b)("pre",null,Object(n.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"# cd into the src folder of the catkin workspace\ngit clone https://github.com/chengguizi/kalibr\ncatkin build kalibr\n# it takes quite a while to compile...\n")),Object(n.b)("p",null,"More on catkin build, refer ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"/docs/linux/ros/using-catkin-build"}),"here"),". To verify the installation, command ",Object(n.b)("inlineCode",{parentName:"p"},"kalibr_calibrate_cameras")," should exist."),Object(n.b)("hr",null),Object(n.b)("h2",{id:"optionally-to-calibrate-imu-camera"},"Optionally to Calibrate IMU-Camera"),Object(n.b)("p",null,"This step is usually not needed, as the calibration result is generally not accurate, especially in the relative position between the IMU and the cameras."),Object(n.b)("p",null,"It might only be useful to serve as a way to determine the mounting position and coordinate systems used in both IMU and the cameras."),Object(n.b)("h3",{id:"the-imu-config-file"},"The IMU Config File"),Object(n.b)("pre",null,Object(n.b)("code",Object(i.a)({parentName:"pre"},{className:"language-yaml",metastring:'title="imu.yaml"',title:'"imu.yaml"'}),"#Accelerometers\naccelerometer_noise_density: 1.86e-03   #Noise density (continuous-time)\naccelerometer_random_walk:   4.33e-04   #Bias random walk\n\n#Gyroscopes\ngyroscope_noise_density:     1.87e-04   #Noise density (continuous-time)\ngyroscope_random_walk:       2.66e-05   #Bias random walk\n\nrostopic:                    /mavros/imu/data     #the IMU ROS topic\nupdate_rate:                 360.0      #Hz (for discretization of the values above)\n")))}s.isMDXComponent=!0}}]);